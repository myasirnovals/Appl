@startuml
title Sequence Diagram - Manajemen Keuangan (Pembayaran, Konfirmasi, Print, Rekening, Refund, Promo)

actor Admin
participant "Web Admin" as App
participant "FinanceController" as Controller
participant "PaymentService" as PaymentSvc
participant "BankService" as BankSvc
participant "RefundService" as RefundSvc
participant "PromoService" as PromoSvc
database "Database" as DB
participant "Printer" as Printer

== Kelola Pembayaran ==
Admin -> App : Akses menu pembayaran
activate App
App -> Controller : getPaymentList()
activate Controller
Controller -> PaymentSvc : fetchPayments()
activate PaymentSvc
PaymentSvc -> DB : query daftar pembayaran
activate DB
DB --> PaymentSvc : payment list
deactivate DB
PaymentSvc --> Controller : payment list
deactivate PaymentSvc
Controller --> App : tampilkan pembayaran
deactivate Controller
deactivate App

Admin -> App : Lihat detail pembayaran
activate App
App -> Controller : getPaymentDetail(paymentId)
activate Controller
Controller -> PaymentSvc : fetchPaymentDetail(paymentId)
activate PaymentSvc
PaymentSvc -> DB : query detail pembayaran
activate DB
DB --> PaymentSvc : payment detail
deactivate DB
PaymentSvc --> Controller : payment detail
deactivate PaymentSvc
Controller --> App : tampilkan detail pembayaran
deactivate Controller
deactivate App

== Konfirmasi Pembayaran Manual ==
Admin -> App : Konfirmasi pembayaran manual
activate App
App -> Controller : confirmManualPayment(paymentId, data)
activate Controller
Controller -> PaymentSvc : confirmManualPayment(paymentId, data)
activate PaymentSvc
PaymentSvc -> DB : update status pembayaran
activate DB
DB --> PaymentSvc : success
deactivate DB
PaymentSvc --> Controller : success
deactivate PaymentSvc
Controller --> App : pembayaran dikonfirmasi
deactivate Controller
deactivate App

== Print Transaksi ==
Admin -> App : Print transaksi
activate App
App -> Controller : printTransaction(paymentId)
activate Controller
Controller -> PaymentSvc : getTransactionData(paymentId)
activate PaymentSvc
PaymentSvc -> DB : ambil data transaksi
activate DB
DB --> PaymentSvc : transaksi data
deactivate DB
PaymentSvc -> Controller : transaksi data
deactivate PaymentSvc
Controller -> Printer : print(transaksi data)
activate Printer
Printer --> Controller : selesai
deactivate Printer
Controller --> App : notifikasi print selesai
deactivate Controller
deactivate App

== Kelola Rekening Bank ==
Admin -> App : Kelola rekening bank
activate App
App -> Controller : getBankAccountList()
activate Controller
Controller -> BankSvc : fetchBankAccounts()
activate BankSvc
BankSvc -> DB : query rekening bank
activate DB
DB --> BankSvc : rekening list
deactivate DB
BankSvc --> Controller : rekening list
deactivate BankSvc
Controller --> App : tampilkan rekening
deactivate Controller
deactivate App

Admin -> App : Tambah/Edit/Hapus rekening
activate App
App -> Controller : saveBankAccount(data) / deleteBankAccount(id)
activate Controller
Controller -> BankSvc : saveBankAccount(data) / deleteBankAccount(id)
activate BankSvc
BankSvc -> DB : insert/update/delete rekening
activate DB
DB --> BankSvc : success
deactivate DB
BankSvc --> Controller : success
deactivate BankSvc
Controller --> App : proses berhasil
deactivate Controller
deactivate App

== Kelola Refund ==
Admin -> App : Proses refund
activate App
App -> Controller : processRefund(refundId, data)
activate Controller
Controller -> RefundSvc : processRefund(refundId, data)
activate RefundSvc
RefundSvc -> DB : update status refund
activate DB
DB --> RefundSvc : success
deactivate DB
RefundSvc --> Controller : success
deactivate RefundSvc
Controller --> App : refund diproses
deactivate Controller
deactivate App

== Kelola Promo/Diskon ==
Admin -> App : Kelola promo/diskon
activate App
App -> Controller : getPromoList()
activate Controller
Controller -> PromoSvc : fetchPromos()
activate PromoSvc
PromoSvc -> DB : query promo/diskon
activate DB
DB --> PromoSvc : promo list
deactivate DB
PromoSvc --> Controller : promo list
deactivate PromoSvc
Controller --> App : tampilkan promo
deactivate Controller
deactivate App

Admin -> App : Tambah/Edit/Hapus promo
activate App
App -> Controller : savePromo(data) / deletePromo(id)
activate Controller
Controller -> PromoSvc : savePromo(data) / deletePromo(id)
activate PromoSvc
PromoSvc -> DB : insert/update/delete promo
activate DB
DB --> PromoSvc : success
deactivate DB
PromoSvc --> Controller : success
deactivate PromoSvc
Controller --> App : proses berhasil
deactivate Controller
deactivate App

' Destruction (opsional, aktifkan jika ingin menampilkan objek di-destroy)
' destroy App
' destroy Controller
' destroy PaymentSvc
' destroy BankSvc
' destroy RefundSvc
' destroy PromoSvc
' destroy Printer

@enduml
